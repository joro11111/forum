{{define "content"}}
<main>
   
    <div class="filters">
        <h3>ğŸ” Filter Posts</h3>
        <div class="filter-options">
            <a href="/" class="filter-btn {{if not .Filter}}active{{end}}">All Posts</a>
            {{if .CurrentUser}}
                <a href="/?filter=my-posts" class="filter-btn {{if eq .Filter "my-posts"}}active{{end}}">My Posts</a>
                <a href="/?filter=liked-posts" class="filter-btn {{if eq .Filter "liked-posts"}}active{{end}}">Liked Posts</a>
            {{end}}
        </div>

        <!-- Dropdown for small screens -->
        <div class="select-wrapper">
            <label for="category-select" class="sr-only">Filter by Category</label>
            <select id="category-select" onchange="updateCategoryFilter()">
                <option value="">All Categories</option>
                {{range .Categories}}
                    <option value="{{.ID}}" {{if eq $.CategoryID (printf "%d" .ID)}}selected{{end}}>{{.Name}}</option>
                {{end}}
            </select>
        </div>

        <!-- List for larger screens -->
        <div class="categories-wrapper">
            <h4>Categories</h4>
            <ul class="categories-list">
                <li><a href="/?category=" class="category-btn {{if not $.CategoryID}}active{{end}}">All Categories</a></li>
                {{range .Categories}}
                    <li><a href="/?category={{.ID}}" class="category-btn {{if eq $.CategoryID (printf "%d" .ID)}}active{{end}}">{{.Name}}</a></li>
                {{end}}
            </ul>
        </div>
    </div>

    <div class="posts-section">
        {{if .Posts}}
            {{range .Posts}}
            <div class="card">
                <h2><a href="/post/{{.ID}}" class="post-title">{{.Title}}</a></h2>
                <div class="post-meta">
                    <strong><a href="/profile/{{.Username}}" class="username-link">{{.Username}}</a></strong> in <strong>{{.CategoryName}}</strong> â€¢ 
                    {{.CreatedAt.Format "January 2, 2006 at 3:04 PM"}}
                </div>
                <div class="post-content">
                    {{if gt (len .Content) 300}}
                        {{slice .Content 0 300}}...
                    {{else}}
                        {{.Content}}
                    {{end}}
                </div>
                <div class="post-actions">
                    {{if $.CurrentUser}}
                        <form method="POST" action="/like-post" class="like-form">
                            <input type="hidden" name="post_id" value="{{.ID}}">
                            <input type="hidden" name="action" value="like">
                            <button type="submit" class="like-btn btn-sm">ğŸ‘ {{.LikesCount}}</button>
                        </form>
                        <form method="POST" action="/like-post" class="like-form">
                            <input type="hidden" name="post_id" value="{{.ID}}">
                            <input type="hidden" name="action" value="dislike">
                            <button type="submit" class="like-btn btn-sm">ğŸ‘ {{.DislikesCount}}</button>
                        </form>
                    {{else}}
                        <span class="like-btn btn-sm">ğŸ‘ {{.LikesCount}}</span>
                        <span class="like-btn btn-sm">ğŸ‘ {{.DislikesCount}}</span>
                    {{end}}
                    <span class="like-btn btn-sm">ğŸ’¬ {{.CommentsCount}} comments</span>
                    <a href="/post/{{.ID}}" class="like-btn btn-sm">Comment</a>
                </div>
            </div>
            {{end}}
        {{else}}
            <div class="card">
                <h2>ğŸ“š No Posts Yet</h2>
                <p>No posts available for the selected filter.</p>
            </div>
        {{end}}
    </div>
</main>
{{end}}
